version: "3.3"

services:
  ipc_logger:
    image: "farmng/base:${TAG:?err}"
    build:
      context: ../../..
      dockerfile: docker/base.Dockerfile
    entrypoint: build/modules/core/cpp/farm_ng/ipc_logger
    user: "${UID}:${GID}"
    network_mode: host
    environment:
      - BLOBSTORE_ROOT=/blobstore
    volumes:
      - "${BLOBSTORE_ROOT:?err}:/blobstore"
  ipc_publisher_test:
    image: "farmng/base:${TAG:?err}"
    build:
      context: ../../..
      dockerfile: docker/base.Dockerfile
    network_mode: host
    entrypoint: ./env.sh python modules/core/tests/ipc_publisher_test.py
