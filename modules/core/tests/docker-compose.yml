version: "3.3"

services:
  ipc_logger:
    image: "farmng/base:${TAG:?err}"
    build:
      context: ../../..
      dockerfile: docker/base.Dockerfile
    entrypoint: build/modules/core/cpp/farm_ng/ipc_logger
    user: "${_UID}:${_GID}"
    environment:
      - BLOBSTORE_ROOT=/blobstore
      - SUBNET_BROADCAST_ADDRESS=255.255.255.255
    volumes:
      - "${BLOBSTORE_ROOT:?err}:/blobstore"
    networks:
      - testnet

  test_runner:
    image: "farmng/base:${TAG:?err}"
    build:
      context: ../../..
      dockerfile: docker/base.Dockerfile
    environment:
      - BLOBSTORE_ROOT=/blobstore
      - SUBNET_BROADCAST_ADDRESS=255.255.255.255
    volumes:
      - "${BLOBSTORE_ROOT:?err}:/blobstore"
    networks:
      - testnet

networks:
  testnet:
    name: "${NETWORK_NAME:?err}"
